---
import ThemeToggle from "./ThemeToggle.astro";

const nav = [
  { label: "Home", href: "/" },
  { label: "Projects", href: "/projects" },
  { label: "Blog", href: "/blog" },
  { label: "Lab Notes", href: "/notes" },
  { label: "Research", href: "/research" },
  { label: "About", href: "/about" },
];

const currentPath = Astro.url.pathname;

function isActive(href: string) {
  if (href === "/") return currentPath === "/";
  return currentPath.startsWith(href);
}

function desktopClass(href: string) {
  return isActive(href)
    ? "satl-navlink satl-navlink--active"
    : "satl-navlink";
}

function mobileClass(href: string) {
  return isActive(href) ? "satl-chip satl-chip--active" : "satl-chip";
}
---

<header class="sticky top-0 z-50 satl-surface satl-surface--bottom backdrop-blur satl-header">
  <div class="mx-auto flex max-w-5xl items-center justify-between px-4 py-3">
    <a href="/" class="flex items-center gap-2 no-underline">
      <span class="text-lg font-bold tracking-tight" style="color: var(--satl-text);">
        SATL Lab
      </span>
      <span class="hidden text-xs sm:inline" style="color: var(--satl-text-dim);">
        circuits · signals · silicon
      </span>
    </a>

    <div class="hidden items-center gap-5 md:flex">
      <nav class="flex items-center gap-5">
        {nav.map((item) => (
          <a href={item.href} class={desktopClass(item.href)}>
            {item.label}
          </a>
        ))}
      </nav>
      <ThemeToggle />
    </div>
  </div>

  <nav class="flex items-center gap-3 overflow-x-auto px-4 pb-3 md:hidden">
    {nav.map((item) => (
      <a href={item.href} class={mobileClass(item.href)}>
        {item.label}
      </a>
    ))}
    <ThemeToggle />
  </nav>
</header>