---
import ThemeToggle from './ThemeToggle.astro';

const nav = [
  { label: "Home", href: "/" },
  { label: "Projects", href: "/projects" },
  { label: "Blog", href: "/blog" },
  { label: "Lab Notes", href: "/notes" },
  { label: "Research", href: "/research" },
  { label: "About", href: "/about" },
];

const currentPath = Astro.url.pathname;

function isActive(href: string) {
  if (href === "/") return currentPath === "/";
  return currentPath.startsWith(href);
}

function desktopClass(href: string) {
  return isActive(href)
    ? "text-sm no-underline transition text-white font-medium border-b border-white pb-0.5"
    : "text-sm no-underline transition text-neutral-400 hover:text-white";
}

function mobileClass(href: string) {
  return isActive(href)
    ? "whitespace-nowrap rounded-full border border-white bg-white text-neutral-950 font-medium px-3 py-1 text-xs no-underline transition"
    : "whitespace-nowrap rounded-full border border-neutral-700 bg-neutral-900 text-neutral-300 px-3 py-1 text-xs no-underline transition hover:bg-neutral-800";
}
---

<header class="sticky top-0 z-50 border-b border-neutral-800 bg-neutral-950/80 backdrop-blur">
  <div class="mx-auto flex max-w-5xl items-center justify-between px-4 py-3">
    <a href="/" class="flex items-center gap-2 no-underline">
      <span class="text-lg font-bold tracking-tight text-white">SATL Lab</span>
      <span class="hidden text-xs text-neutral-500 sm:inline">circuits · signals · silicon</span>
    </a>

    <div class="hidden items-center gap-5 md:flex">
      <nav class="flex items-center gap-5">
        {nav.map((item) => (
          <a href={item.href} class={desktopClass(item.href)}>
            {item.label}
          </a>
        ))}
      </nav>
      <ThemeToggle />
    </div>
  </div>

  <nav class="flex items-center gap-3 overflow-x-auto px-4 pb-3 md:hidden">
    {nav.map((item) => (
      <a href={item.href} class={mobileClass(item.href)}>
        {item.label}
      </a>
    ))}
    <ThemeToggle />
  </nav>
</header>